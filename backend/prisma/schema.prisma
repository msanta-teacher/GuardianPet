generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model enfermedad {
  id             Int             @id @default(autoincrement())
  tipo           String          @db.VarChar(255)
  fecha_inicio   DateTime        @db.DateTime(0)
  fecha_fin      DateTime        @db.DateTime(0)
  descripci_n    String          @map("descripción") @db.Text
  det_enfermedad det_enfermedad?
}

model historial_clinico {
  id                Int             @id @default(autoincrement())
  fecha             DateTime        @db.DateTime(0)
  descripcion       String          @db.Text
  tipo              String          @db.VarChar(255)
  url_archivos      String?         @db.VarChar(255)
  veterinario_id_fk Int             @unique(map: "veterinario_id_fk")
  mascota_id_fk     Int             @unique(map: "mascota_id_fk")
  cita_id_fk        Int?            @unique(map: "cita_id_fk")
  det_enfermedad    det_enfermedad?
  det_operacion     det_operacion?
  det_vacuna        det_vacuna?
  veterinario       veterinario     @relation(fields: [veterinario_id_fk], references: [id], onUpdate: Restrict, map: "historial_clinico_ibfk_1")
  mascota           mascota         @relation(fields: [mascota_id_fk], references: [id], onUpdate: Restrict, map: "historial_clinico_ibfk_2")
  cita              cita?           @relation(fields: [cita_id_fk], references: [id], onDelete: Restrict, onUpdate: Restrict, map: "historial_clinico_ibfk_3")
}

model mascota {
  id                Int                @id @default(autoincrement())
  nombre            String             @db.VarChar(255)
  especie           String             @db.VarChar(255)
  raza              String             @db.VarChar(255)
  sexo              String             @db.VarChar(255)
  fecha_nacimiento  DateTime           @db.Date
  usuario_id_fk     Int                @unique(map: "usuario_id_fk")
  url_foto          String?            @db.VarChar(255)
  historial_clinico historial_clinico?
  usuario           usuario            @relation(fields: [usuario_id_fk], references: [id], onUpdate: Restrict, map: "mascota_ibfk_1")
}

model operacion {
  id            Int            @id @default(autoincrement())
  tipo          String         @db.VarChar(255)
  fecha         DateTime       @db.DateTime(0)
  descripci_n   String         @map("descripción") @db.Text
  det_operacion det_operacion?
}

model tratamiento {
  id               Int      @id @default(autoincrement())
  tipo             Int
  fecha            DateTime @db.DateTime(0)
  fecha_fin        Int
  descripci_n      String   @map("descripción") @db.Text
  enfermedad_id_fk Int      @unique(map: "enfermedad_id_fk")
}

model usuario {
  id         Int      @id @default(autoincrement())
  nombre     String   @db.VarChar(255)
  email      String   @unique(map: "email") @db.VarChar(255)
  telefono   String   @db.VarChar(255)
  contrasena String   @db.VarChar(255)
  rol        String   @db.VarChar(255)
  cedula     Int      @unique(map: "cedula")
  cita       cita?
  mascota    mascota?
}

model vacuna {
  id          Int         @id @default(autoincrement())
  nombre      String      @db.VarChar(255)
  fecha       DateTime    @db.DateTime(0)
  descripci_n String      @map("descripción") @db.VarChar(255)
  det_vacuna  det_vacuna?
}

model veterinario {
  id                Int                @id @default(autoincrement())
  nombre            DateTime           @db.Date
  email             String             @db.VarChar(255)
  matricula         String             @db.VarChar(255)
  cita              cita?
  historial_clinico historial_clinico?
}

model cita {
  id                Int                @id
  fecha             DateTime           @db.DateTime(0)
  usuario_id_fk     Int                @unique(map: "usuario_id")
  estado            String             @db.VarChar(255)
  veterinario_id_fk Int                @unique(map: "veterinario_id_fk")
  observacion       String             @db.Text
  veterinario       veterinario        @relation(fields: [veterinario_id_fk], references: [id], onUpdate: Restrict, map: "cita_ibfk_1")
  usuario           usuario            @relation(fields: [id], references: [id], onUpdate: Restrict, map: "cita_ibfk_2")
  historial_clinico historial_clinico?
}

model clinica {
  id        Int    @id @default(autoincrement())
  tienda    String @db.VarChar(255)
  direcci_n String @map("dirección") @db.VarChar(255)
  telefono  String @db.VarChar(255)
  latitud   Float
  longitud  Float
}

model det_enfermedad {
  id                      Int               @id
  historial_clinico_id_fk Int               @unique(map: "historial_clinico_id_fk")
  enfermedad_id_fk        Int               @unique(map: "enfermedad_id_fk")
  historial_clinico       historial_clinico @relation(fields: [historial_clinico_id_fk], references: [id], onUpdate: Restrict, map: "det_enfermedad_ibfk_1")
  enfermedad              enfermedad        @relation(fields: [enfermedad_id_fk], references: [id], onUpdate: Restrict, map: "det_enfermedad_ibfk_2")
}

model det_operacion {
  id                      Int               @id
  historial_clinico_id_fk Int               @unique(map: "historial_clinico_id_fk")
  operacion_id_fk         Int               @unique(map: "operacion_id_fk")
  historial_clinico       historial_clinico @relation(fields: [historial_clinico_id_fk], references: [id], onUpdate: Restrict, map: "det_operacion_ibfk_1")
  operacion               operacion         @relation(fields: [operacion_id_fk], references: [id], onUpdate: Restrict, map: "det_operacion_ibfk_2")
}

model det_vacuna {
  id                      Int               @id
  historial_clinico_id_fk Int               @unique(map: "historial_clinico_id_fk")
  vacuna_id_fk            Int               @unique(map: "vacuna_id_fk")
  historial_clinico       historial_clinico @relation(fields: [historial_clinico_id_fk], references: [id], onUpdate: Restrict, map: "det_vacuna_ibfk_1")
  vacuna                  vacuna            @relation(fields: [vacuna_id_fk], references: [id], onUpdate: Restrict, map: "det_vacuna_ibfk_2")
}
